# ๐ฆ Ubaar task

## User Flow โ ุชุฌุฑุจู ฺฉุงุฑุจุฑ

ฑ. **ฺฉุงุฑุจุฑ ุดูุงุฑู ููุจุงู ุฎูุฏ ุฑุง ูุงุฑุฏ ูโฺฉูุฏ.**  
ฒ. **ฺฉุฏ ุชุฃุฏ (OTP) ุจู ุดูุงุฑู ุงุฑุณุงู ูโุดูุฏ.**  
ณ. **ฺฉุงุฑุจุฑ ูพุณ ุงุฒ ุฏุฑุงูุช OTPุ ุขู ุฑุง ุฏุฑ ุจุฑูุงูู ูุงุฑุฏ ูโฺฉูุฏ.**  
ด. **ุฏุฑ ุตูุฑุช ูุงุฒุ ุฑูุฒ ุนุจูุฑ ูุฒ ูุงุฑุฏ ูโุดูุฏ.**  
ต. **ุฏุฑ ุตูุฑุช ูุฑูุฏ ููููุ ุชูฺฉู ุง ูพุงู ุชุฃุฏ ุจุงุฒูโฺฏุฑุฏุฏ.**

---

## OTP Rate Limiting
- ุจุนุฏ ุงุฒ ูุฑ ุงุฑุณุงู OTPุ ุจุงุฏ **ณ ุฏููู** ุตุจุฑ ุดูุฏ.

## block after 3 unsuccessfull attemps
- ุจุด ุงุฒ **ณ ุชูุงุด ูุงูููู** (ูุฑูุฏ ุงุดุชุจุงู ุฑูุฒ ุง OTP) ุฏุฑ ูุฏุช **ฑ ุณุงุนุช** ุจุงุนุซ **ุจูุงฺฉ ุดุฏู** ูููุช ฺฉุงุฑุจุฑ ูโุดูุฏ.

---

## API Endpoints

### 1. ุฏุฑุฎูุงุณุช ฺฉุฏ ูุฑูุฏ (registered or not)

`POST /api/auth/request-login/`

####  Request Body:

```json
{
  "phone_number": "09123456789"
}
```

#### output
```json
{
    "registered": true or false
}
```
## if registered = false
### 2. ุฏุฑุฎูุงุณุช ฺฉุฏ ฺฉ ุจุงุฑ ูุตุฑู (OTP)
`POST /api/auth/request-otp/`

####  Request Body:

```json
{
  "phone_number": "09123456789"
}
```
#### output
```json
{
    "detail": "ฺฉุฏ ุงุฑุณุงู ุดุฏ (ฺฉุฏ: ******)"
}
```

## ุงฺฏุฑ ูุจู ุงุฒ ุณู ุฏููู ุฏุฑุฎูุงุณุช ุจุฒูุฏ
```json
{
    "detail": "ูุทูุงู ณ ุฏููู ุตุจุฑ ฺฉูุฏ ู ุณูพุณ ุฏูุจุงุฑู ุชูุงุด ฺฉูุฏ."
}
```

### ุตุญุช ุณูุฌ ฺฉุฏ ฺฉ ุจุงุฑ ูุตุฑู
`POST /api/auth/verify-otp/`

####  Request Body:

```json
{
    "phone_number": "09369109944", 
    "code": "841839"
}
```

#### output

```json
{
    "detail": "ูุฑูุฏ ูููู",
    "new_user": true
}
```

#### ุงฺฏุฑ ุจุดุชุฑ ุงุฒ ุณู ุจุงุฑ ุงุดุชุจุงู ุจุฒูุฏ
```json
{
    "detail": "ุจู ุฏูู ุชูุงุดโูุง ูุงููููุ ุฏุณุชุฑุณ ุดูุง ุจู ูุฏุช ฑ ุณุงุนุช ูุญุฏูุฏ ุดุฏู ุงุณุช."
}
```

### ุงุถุงูู ฺฉุฑุฏู ูุงู ู ูุงู ุฎุงููุงุฏฺฏ
`POST /api/auth/set-profile/`

####  Request Body:

```json
{
    "phone_number": "09369109944", 
    "first_name": "ุนู", 
    "last_name": "ุณูุน ุฒุงุฏู"
}
```

#### output
```json
{
    "detail": "ุงุทูุงุนุงุช ุจุง ููููุช ุฐุฎุฑู ุดุฏ"
}
```

### ุงุถุงูู ฺฉุฑุฏู ูพุณูุฑุฏ
`POST /api/auth/set-password/`

####  Request Body:

```json
{
    "phone_number": "09369109944", 
    "password": "12345678"
}
```

#### output
```json
{
    "message": "ุฑูุฒ ุนุจูุฑ ุจุง ููููุช ุชูุธู ุดุฏ."
}
```

## if registered = true

### ูุงฺฏู ุจุง ูพุณูุฑุฏ
`POST /api/auth/login-password/`

####  Request Body:

```json
{
    "phone_number": "09369109944", 
    "password": "1235678"
}
```
#### output

```json
{
    "detail": "ูุฑูุฏ ูููู"
}
```

#### ุงฺฏุฑ ุจุดุชุฑ ุงุฒ ุณู ุจุงุฑ ุงุดุชุจุงู ุจุฒูุฏ
```json
{
    "detail": "ุจู ุฏูู ุชูุงุดโูุง ูุงููููุ ุฏุณุชุฑุณ ุดูุง ุจู ูุฏุช ฑ ุณุงุนุช ูุญุฏูุฏ ุดุฏู ุงุณุช."
}
```
